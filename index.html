<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ“Š Payment & Call Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <!-- CSS -->
  <style>
    * { box-sizing: border-box; }
    body, html { margin: 0; padding: 0; height: 100%; font-family: Arial, sans-serif; background: #f7f9fc; }
    header { background: #1e293b; color: white; padding: 1rem; text-align: center; font-size: 1.5rem; }
    nav { display: flex; justify-content: center; background: #334155; }
    nav button { flex: 1; background: none; border: none; color: white; padding: 1rem; font-size: 1rem; cursor: pointer; }
    nav button.active { background: #475569; }
    .container { display: flex; flex-direction: column; height: calc(100% - 120px); padding: 1rem; max-width: 1200px; margin: auto; }
    .tab { flex: 1; overflow-y: auto; }
    .card { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
    h2 { margin-top: 0; font-size: 1.3rem; }
    form { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1rem; }
    input, select, button { padding: 0.8rem; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; width: 100%; }
    button { background: #2563eb; color: white; border: none; cursor: pointer; transition: background 0.2s; }
    button:hover { background: #1e40af; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    table th, table td { padding: 0.8rem; border: 1px solid #e5e7eb; text-align: left; }
    table th { background: #f1f5f9; }
    .action-btn { background: #dc2626; margin-left: 0.5rem; }
    .action-btn:hover { background: #991b1b; }
    .missed-btn { background: #f59e0b; }
    .missed-btn:hover { background: #b45309; }
    .paid-btn { background: #16a34a; }
    .paid-btn:hover { background: #14532d; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <header>ðŸ“Š Payment & Call Tracker</header>
  <nav>
    <button id="tab-subs" class="active" onclick="showTab('subs')">Subscribers</button>
    <button id="tab-calls" onclick="showTab('calls')">Calls</button>
  </nav>

  <div class="container">
    <!-- Subscribers Tab -->
    <div id="subs" class="tab">
      <div class="card">
        <h2>Add Subscriber</h2>
        <form id="subscriberForm">
          <input id="name" placeholder="Full Name" required>
          <input id="phone" placeholder="Phone Number" required>
          <input id="amount" type="number" placeholder="Payment Amount" required>
          <input id="start" type="date" required>
          <select id="frequency">
            <option value="1">Every Month</option>
            <option value="2">Every 2 Months</option>
            <option value="3">Every 3 Months</option>
            <option value="6">Every 6 Months</option>
            <option value="12">Every Year</option>
          </select>
          <button type="submit">âž• Add Subscriber</button>
        </form>
      </div>

      <div class="card">
        <h2>Subscribers List</h2>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Phone</th>
              <th>Amount</th>
              <th>Start Date</th>
              <th>Frequency</th>
              <th>Missed</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="subsList"></tbody>
        </table>
      </div>
    </div>

    <!-- Calls Tab -->
    <div id="calls" class="tab hidden">
      <div class="card">
        <h2>Add Call Reminder</h2>
        <form id="callForm">
          <input id="cname" placeholder="Full Name" required>
          <input id="cphone" placeholder="Phone Number" required>
          <input id="reason" placeholder="Reason for Call" required>
          <input id="calltime" type="datetime-local" required>
          <button type="submit">ðŸ“ž Add Call Reminder</button>
        </form>
      </div>

      <div class="card">
        <h2>Calls List</h2>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Phone</th>
              <th>Reason</th>
              <th>Call Time</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="callsList"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // âœ… Firebase Config (replace with your own)
    const firebaseConfig = {
      apiKey: "AIzaSyARDR6swjAEg9barRiyiBjRg1BmRp5sT3k",
      authDomain: "subscription-call-reminder.firebaseapp.com",
      projectId: "subscription-call-reminder",
      storageBucket: "subscription-call-reminder.appspot.com",
      messagingSenderId: "159707301624",
      appId: "1:159707301624:web:7accb3c4b08e4e9f53dd0d"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Tab switching
    function showTab(tab) {
      document.getElementById("subs").classList.add("hidden");
      document.getElementById("calls").classList.add("hidden");
      document.getElementById(tab).classList.remove("hidden");
      document.getElementById("tab-subs").classList.remove("active");
      document.getElementById("tab-calls").classList.remove("active");
      document.getElementById("tab-" + tab).classList.add("active");
    }

    // Add Subscriber
    document.getElementById("subscriberForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      try {
        await db.collection("subscribers").add({
          name: document.getElementById("name").value,
          phone: document.getElementById("phone").value,
          amount: parseFloat(document.getElementById("amount").value),
          startDate: document.getElementById("start").value,
          frequency: parseInt(document.getElementById("frequency").value),
          missed: 0,
        });
        e.target.reset();
      } catch (err) {
        alert("Error adding subscriber: " + err.message);
      }
    });

    // Add Call
    document.getElementById("callForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      try {
        await db.collection("calls").add({
          name: document.getElementById("cname").value,
          phone: document.getElementById("cphone").value,
          reason: document.getElementById("reason").value,
          callTime: document.getElementById("calltime").value,
        });
        e.target.reset();
      } catch (err) {
        alert("Error adding call: " + err.message);
      }
    });

    // Display Subscribers
    db.collection("subscribers").onSnapshot(snapshot => {
      const list = document.getElementById("subsList");
      list.innerHTML = "";
      snapshot.forEach(doc => {
        const s = doc.data();
        list.innerHTML += `<tr>
          <td>${s.name}</td>
          <td>${s.phone}</td>
          <td>$${s.amount}</td>
          <td>${s.startDate}</td>
          <td>Every ${s.frequency} month(s)</td>
          <td>${s.missed || 0}</td>
          <td>
            <button class="missed-btn" onclick="addMissed('${doc.id}', ${s.missed || 0})">âž• Missed</button>
            <button class="paid-btn" onclick="markPaid('${doc.id}')">âœ… Paid</button>
            <button class="action-btn" onclick="deleteSubscriber('${doc.id}')">ðŸ—‘ Remove</button>
          </td>
        </tr>`;
      });
    });

    // Display Calls
    db.collection("calls").onSnapshot(snapshot => {
      const list = document.getElementById("callsList");
      list.innerHTML = "";
      snapshot.forEach(doc => {
        const c = doc.data();
        list.innerHTML += `<tr>
          <td>${c.name}</td>
          <td>${c.phone}</td>
          <td>${c.reason}</td>
          <td>${c.callTime}</td>
          <td><button class="action-btn" onclick="deleteCall('${doc.id}')">ðŸ—‘ Remove</button></td>
        </tr>`;
      });
    });

    // Actions
    async function deleteSubscriber(id) { await db.collection("subscribers").doc(id).delete(); }
    async function deleteCall(id) { await db.collection("calls").doc(id).delete(); }
    async function addMissed(id, current) { await db.collection("subscribers").doc(id).update({ missed: current + 1 }); }
    async function markPaid(id) { await db.collection("subscribers").doc(id).update({ missed: 0 }); }
  </script>
</body>
</html>
